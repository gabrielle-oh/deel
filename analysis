/* Count of statuses */
SELECT state, COUNT(state)
FROM acceptance
GROUP BY state; -- Declined: 1653, accepted: 3777

/* Checking for correlation between declines and country */
SELECT country,
        SUM(state) AS declines
FROM a_converted -- version of Acceptance report with Declines as 1's and Acceptances as 0's
GROUP BY country; -- no significant distribution

/* Checking for correlation between declines and currency */
SELECT currency,
        SUM(state) AS declines,
        COUNT(currency) AS total_tran
FROM a_converted
GROUP BY currency; -- USD has slightly higher ratio of declines but not statistically significant

/* Checking for correlation between dates and declines */
SELECT DATE_TRUNC('day', date_time) AS date,
        SUM(state) AS declines,
        COUNT(external_ref) AS total_tran
FROM a_converted
GROUP BY date
ORDER BY declines DESC;

/* Checking for correlation between week and declines */
SELECT DATE_TRUNC('week', date_time) AS week,
        SUM(state) AS declines,
        COUNT(external_ref) AS total_tran
FROM a_converted
GROUP BY week
ORDER BY declines DESC;
